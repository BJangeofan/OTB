language: cpp

sudo: false

compiler:
- clang

addons:
  apt:
    packages:
    - libqt4-dev
    - libqtcore4
    - libqtgui4

before_script:
  - export SOURCE_DIR=$PWD
  - export GIT_BRANCH=`git rev-parse --abbrev-ref HEAD`
  - cd /tmp
  - wget https://cmake.org/files/v3.4/cmake-3.4.0-rc3-Linux-x86_64.tar.gz --no-check-certificate
  - tar -xzf cmake-3.4.0-rc3-Linux-x86_64.tar.gz
  - wget https://github.com/martine/ninja/releases/download/v1.6.0/ninja-linux.zip --no-check-certificate
  - unzip ninja-linux.zip
  - wget https://www.orfeo-toolbox.org/packages/xdk/OTB-xdk-Linux64.run  --no-check-certificate
  - chmod +x /tmp/OTB-xdk-Linux64.run
  - /tmp/OTB-xdk-Linux64.run
  - cd $SOURCE_DIR/../
  - mkdir build
  - cd build

script: /tmp/cmake-3.4.0-rc3-Linux-x86_64/bin/ctest -M Continuous -DSITE:STRING="travis-ci.org" -DCTEST_BUILDNAME:STRING="travis-$GIT_BRANCH" -DCMAKE_MAKE_PROGRAM:FILEPATH=/tmp/ninja -DCTEST_USE_LAUNCHERS:BOOL=ON -DDART_TESTING_TIMEOUT:STRING=1500 -DCTEST_NIGHTLY_START_TIME="20:00:00 CEST" -DCTEST_DROP_METHOD="http" -DCTEST_DROP_SITE="dash.orfeo-toolbox.org" -DCTEST_DROP_LOCATION="/submit.php?project=OTB" -DCTEST_DROP_SITE_CDASH=TRUE -DCTEST_TEST_TIMEOUT=1500 -DCMAKE_CXX_FLAGS='-w' -DOTB_BUILD_DEFAULT_MODULES:BOOL=OFF -DOTBGroup_ThirdParty:BOOL=ON -DOTB_USE_6S:BOOL=OFF -DOTB_USE_SIFTFAST:BOOL=OFF -DCMAKE_BUILD_TYPE=Release -DCMAKE_PREFIX_PATH=/tmp/OTB-xdk-Linux64 -DBUILD_TESTING=ON -T Configure -T Submit